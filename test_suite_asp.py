from pages import *
from links import Links


class TestSuite:

    driver = webdriver.Chrome("driver\\chromedriver.exe")

    @classmethod
    def setup_class(cls):
        cls.driver.maximize_window()
        cls.driver.get(Links.main_page)

    @classmethod
    def teardown_class(cls):
        cls.driver.quit()

    def test_login(self):
        """
        Авторизация на портале
        """
        page = LoginPage(self.driver)
        page.username("Test1")
        page.password("123")
        page.submit()
        page.wait.text_appear("Бухгалтерский учет")

    def te1st_contract_with_supplier(self):
        page = ContractWithSupplierPage(self.driver)
        page.select_month("Январь", "2018")
        page.click_by_text("Договор с поставщиком")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page.document_type("Договор")
        page.number("1")
        page.date("10.01.2018")
        page.counter_party("ПАО \"МегаФон\"")
        page.bank_account_number('40702810838180130496')
        page.uin("123123123")
        page.currency("Российский рубль")
        page.date_begin("10.01.2018")
        page.date_end("10.11.2018")
        page.payment_type("аванс")
        page.subject_contract("Услуги связи")
        page.payment_terms("Ежемесячно равными долями")
        page.note("Авансовые платежи")
        sleep(1)
        # Заполнение строки документа
        page.click_by_text("Детализация по КБК")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = ContractWithSupplierPageDetailKBK(self.driver)
        page.financial_year("2018")
        page.entry_date("10.01.2018")
        page.operation("Принятые БО текущего года  (221)")
        page.kbk("0411 0000000000 000")
        page.kosgu("221")
        sleep(5)
        page.amounts_nds_percent("13")
        page.amounts_amount("1200000")
        page.advance("120000")
        page.checker.check_text_input("amountsAmountWithoutNds", "1 061 946,90")
        page.checker.check_text_input("amountsNdsAmount", "138 053,10")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        # Проверка заполненой суммы
        # Создание копии документа
        page = ContractWithSupplierPage(self.driver)
        page.select_month("Январь", "2018")
        page.table_select_row('ПАО "МегаФон"', 'Выбор документа из которого будем делать копию')
        page.click_by_text("Добавить")
        page.click_by_text("Копию документа")
        sleep(1)
        page.click_by_text("С обнулением суммы")
        sleep(1)
        page.number("2")
        page.date("10.01.2018")
        page.counter_party("ФГУ Автобаза №2")
        # page.bank_account_number(r'40702810838180130496 | ПАО "МегаФон"')
        page.bank_account_number('40503810800001009002')
        page.uin("12345678901234567890")
        page.currency("Российский рубль")
        page.date_begin("10.01.2018")
        page.date_end("10.11.2018")
        page.payment_type("аванс")
        page.subject_contract("Транспортные услуги")
        page.payment_terms("Ежемесячно равными долями")
        page.note("Авансовые платежи")
        sleep(1)
        page.click_by_text("Детализация по КБК")
        page.click_by_text("Открыть")
        sleep(1)
        # Заполнение строки документа
        page = ContractWithSupplierPageDetailKBK(self.driver)
        page.financial_year("2018")
        page.entry_date("10.01.2018")
        page.operation("Принятые БО текущего года  (222)")
        page.kbk("0411 0000000000 000")
        page.kosgu("222")
        sleep(5)
        page.cost_element("Транспортные услуги")
        page.amounts_nds_percent("13")
        page.amounts_amount("1800000")
        page.advance("180000")
        page.checker.check_text_input("amountsAmountWithoutNds", "1 592 920,35")
        page.checker.check_text_input("amountsNdsAmount", "207 079,65")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_application_cash_flow(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Январь", "2018")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        sleep(1)
        page.documen_type("Платежное поручение")
        page.number("1")
        page.date("10.01.2018")
        page.limit_date("10.12.2018")
        page.personal_account("ПАО Банк ВТБ")
        page.recipient('ПАО "МегаФон"')
        page.bank_account_number("40702810838180130496")
        page.number_ufk("123456789012345")
        page.click_by_text("Реквизиты документа")
        page.priority_of_payment("1")
        page.payment_type("4 – срочно")
        page.payment_purpose("paymentPurpose- Test")
        # Заполнение вкладки документ основание
        page.click_by_text("Документ-основание")
        page.foundation("1 от 10.01.2018")
        page.checker.check_text_select("documentFoundaiontKind", 'Договор с поставщиком')
        page.checker.check_text_input("documentFoundationNumber", '1')
        page.checker.check_text_input("documentFoundationSubject", 'Услуги связи')
        page.checker.check_text_input("documentFoundationDate", '10.01.2018')
        # Расшифровка заявки - добавление строки
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = DecodingOfTheApplicationPage(self.driver)
        page.type_of_funds("1 - Средства бюджета")
        page.kbk("0411 0000000000 000")
        page.operation("(221) Оплата за услуги связи")
        page.kosgu("221")
        sleep(5)
        page.cost_element("Услуги связи")
        page.amount("100000")
        page.nds_percent("18")
        page.checker.check_text_input("amountWithoutNds", "84 745,76", 2)
        page.checker.check_text_input("ndsAmount", "15 254,24", 2)
        page.document_foundation_counterparty('ПАО "МегаФон"')
        page.foundation("1 от 10.01.2018")
        page.comment("Оплата за услуги связи Январь 2018")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        sleep(1)
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input("paymentPurpose",
                                      "(07104110000000000000 221 - 100000.00)(л/сч )Услуги связи,в т.ч.НДС 15254.24")
        page.click_by_text("Сохранить")
        # Добавляем копию строки
        page.click_by_text("Расшифровка заявки")
        # Исправить после доработки функционала!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        # page.click_by_text("Добавить")
        # page.click_by_text("Копию строки")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.comment("Строка для удаления")
        sleep(5)
        # page.wait.text_disappear("Документ сохранён")
        page.click_by_text("Сохранить", 2)
        page.search_string('Строка для удаления', 'Выбор строки для удаления')
        page.table_select_row_click('Строка для удаления')
        page.click_by_text("Удалить")
        page.click_by_text("Да")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        # Создание копии документа
        page.table_select_row('ПАО "МегаФон"')
        page.click_by_text("Добавить")
        page.click_by_text("Копию документа")
        page = ApplicationCashFlowPage(self.driver)
        sleep(1)
        page.documen_type("Платежное поручение")
        page.number("2")
        page.date("10.01.2018")
        page.limit_date("10.12.2018")
        page.personal_account("ПАО Банк ВТБ")
        page.recipient('ФГУ Автобаза №2')
        page.bank_account_number("40503810800001009002")
        page.number_ufk("123456789012345")
        # Заполнение вкладки дкоумент основание
        page.click_by_text("Документ-основание")
        page.foundation("2 от 10.01.2018")
        page.checker.check_text_select("documentFoundaiontKind", 'Договор с поставщиком')
        page.checker.check_text_input("documentFoundationNumber", '2')
        page.checker.check_text_input("documentFoundationSubject", 'Транспортные услуги')
        page.checker.check_text_input("documentFoundationDate", '10.01.2018')
        # редактируем строку
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Открыть")
        page = DecodingOfTheApplicationPage(self.driver)
        page.type_of_funds("1 - Средства бюджета")
        page.kbk("0411 0000000000 000")
        page.operation("(222) Оплата за транспортные услуги")
        page.kosgu("222")
        sleep(5)
        page.cost_element("Транспортные услуги")
        page.amount("150000")
        page.nds_percent("18")
        page.checker.check_text_input("amountWithoutNds", "127 118,64", 2)
        page.checker.check_text_input("ndsAmount", "22 881,36", 2)
        page.document_foundation_counterparty('ФГУ Автобаза №2')
        page.foundation("2 от 10.01.2018")
        page.comment("Оплата транспортных услуг Январь 2018")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input("paymentPurpose",
                                      "(07104110000000000000 222 - 150000.00)(л/сч )"
                                      "Транспортные услуги,в т.ч.НДС 22881.36")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        sleep(3)

    # Проведение документов
    def te1st_carrying_out_of_documents(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Январь", "2018")
        page.table_select_row('ПАО "МегаФон"')
        page.table_select_row('ФГУ Автобаза №2')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("10.01.2018")
        # page.operation_master("") указываем если требуется проводку
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.click_by_text("Закрыть")
        # Проверка печатных форм
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Январь", "2018")
        page.table_select_row('ПАО "МегаФон"')
        page.click_by_text("Печать")
        sleep(15)
        File.compare_files('Заявка на кассовый расход.xls')

    def te1st_payment_order_through_contract_with_the_supplier(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ContractWithSupplierPage(self.driver, 5)
        page.select_month("Январь", "2018")
        page.click_by_text("Договор с поставщиком")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page.document_type("Договор")
        page.number("3")
        page.date("24.01.2018")
        sleep(4)
        page.counter_party(' Акционерное общество "Ай-Теко"')
        page.bank_account_number('40702810300000114301')
        page.uin("123123123")
        page.currency("Российский рубль")
        page.date_begin("10.01.2018")
        page.date_end("10.11.2018")
        page.payment_type("аванс")
        page.subject_contract("по счетам/этапам")
        page.payment_terms("Факт поставки, подтвержденный накладными")
        page.note("Поставка оборудования")
        sleep(1)
        # Заполнение строки документа
        page.click_by_text("Детализация по КБК")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = ContractWithSupplierPageDetailKBK(self.driver)
        page.financial_year("2018")
        page.entry_date("20.01.2018")
        page.operation("Принятые БО текущего года  (310)")
        page.kbk("0411 0000000000 000")
        page.kosgu("310")
        sleep(3)
        page.amounts_amount("35000")
        page.checker.check_text_input("amountsAmountWithoutNds", "35 000,00")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    # Добавляем документ счет от поставщика
    def te1st_invoice_from_the_supplier(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Счет от поставщика")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = InvoiceFromTheSupplierPage(self.driver)
        page.document_number("3")
        page.document_date("28.01.2018")
        page.supplier(' Акционерное общество "Ай-Теко"')
        page.supplier_account_detail("40702810300000114301")
        page.account_details("ПАО Банк ВТБ")
        # page.department("Департамент внешних коммуникаций")
        page.note('Поставка оборудования , январь 2018')
        sleep(4)

    # Добавляем документ счет от поставщика строку
        page = InvoiceFromTheSupplierAddLinePage(self.driver)
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.kbk("0411 0000000000 000")
        page.kosgu("310")
        page.cost_element("основные средства")
        page.comment("Поставка оборудования в январе")
        page.amount("125 000,00")
        page.vat_percent("18")
        page.checker.check_text_input("amountWithoutNds", "105 932,20", 2)
        page.checker.check_text_input("ndsAmount", "19 067,80", 2)
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Добавить")
        page.click_by_text("Копию строки")
        page.wait.text_appear("Вопрос")
        page.click_by_text("С обнулением суммы")
        page.table_select_row_click('основные средства', order=2)
        page.click_by_text("Открыть")
        page.comment("Строка для удаления")
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('Строка для удаления')
        page.click_by_text("Удалить")
        page.click_by_text("Да")
        page.click_by_text("Сохранить")
        page.click_by_text("Группировка по аналитикам")
        # Вставить проверку таблицы
        page.click_by_text("Закрыть", order=2)
        page.click_by_text("Закрыть")

    def te1st_creation_of_a_payment_order_based_on_an_invoice(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Счет от поставщика")
        page = ApplicationCashFlowPage(self.driver)
        page.table_select_row('Акционерное общество "Ай-Теко"')
        page.click_by_text("Действие")
        element = self.driver.find_element(By.XPATH, "//li[a='Создать документ по выбору']")
        page.move_to_element(element)
        page.click_by_text("Заявка на кассовый расход")
        page.checker.check_text_select('documentKind', 'Заявка на кассовый расход')
        page.number("3")
        page.date("31.01.2018")
        page.limit_date("31.12.2018")
        page.personal_account("УФК л/с 03951000710")
        page.checker.check_text_select('counterparty', ' Акционерное общество "Ай-Теко"')
        page.checker.check_text_select('counterpartyAccountDetails', "40702810300000114301")
        page.number_ufk("123456789012345")
        page.operation('Оплата за приобретение ОС')
        page.priority_of_payment('5')
        page.payment_type('4 – срочно')
        page.payment_purpose("TEST")

        # Заполнение вкладки документ основание
        page.click_by_text("Документ-основание")
        page.checker.check_text_select("foundation", '3 от 28.01.2018')
        page.checker.check_text_select("documentFoundaiontKind", 'Счет от поставщика')
        page.checker.check_text_input("documentFoundationNumber", '3')
        page.checker.check_text_input("documentFoundationSubject", 'Поставка оборудования , январь 2018')
        page.checker.check_text_input("documentFoundationDate", '28.01.2018')
        # Расшифровка заявки - добавление строки
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Открыть")

        page = DecodingOfTheApplicationPage(self.driver)
        # page.kbk("0411 0000000000 000")

        page.checker.check_text_input("amountWithoutNds", "105 932,20", 2)
        page.checker.check_text_input("ndsAmount", "19 067,80", 2)
        page.document_foundation_counterparty(' Акционерное общество "Ай-Теко"')
        page.foundation("3 от 28.01.2018")

        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input("paymentPurpose",
                                      "(07104110000000000000 310 - 125000.00)(л/сч 03951000710)"
                                      "Увеличение стоимости основных средств,в т.ч.НДС 19067.80")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_carrying_out_of_documents_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Январь", "2018")
        page.table_select_row('Акционерное общество "Ай-Теко"')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("31.01.2018")
        # page.operation_master("") указываем если требуется проводку
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.click_by_text("Закрыть")
        # Проверка печатных форм
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Январь", "2018")
        page.table_select_row('Акционерное общество "Ай-Теко"')
        page.click_by_text("Печать")
        sleep(10)
        # page.file.file_copy('Заявка на кассовый расход.xls')
        File.compare_files('Заявка на кассовый расход (1).xls')
        sleep(10)

    def te1st_turnover_statement_one(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Оборотная ведомость", 2)
        page = TurnoverStatementPage(self.driver)
        page.date_from("01.01.2018")
        page.date_to("31.01.2018")
        page.click_by_text("Показать")
        page.wait.text_appear('Печать "Оборотная ведомость"')
        page.click_by_text('Печать "Оборотная ведомость"')
        sleep(10)
        File.compare_files('Оборотная ведомость.xls')

    def te1st_incoming_order(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = IncomingOrderPage(self.driver)
        page.document_kind("Приходный кассовый ордер (получение наличных из банка в кассу по чеку)")
        page.document_number("1")
        page.document_date("21.01.2018")
        page.employee("Старостина Е.В.")
        page.checker.check_text_input("receivedFrom", "Старостина Е.В.")
        page.received_from("Снято с расчетного счета")
        page.cash_report_number("1234567890")
        page.foundation("Чек 12125")
        page.operation('Снятие наличных в кассу')
    # добавление строк в пко
        page = IncomingOrderAddLinePage(self.driver)
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("221")
        page.expense_type("Услуги связи")
        page.amount("120 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "100 000,00")
        page.checker.check_text_input("ndsAmount", "20 000,00")
        page.comment("Услуги связи")
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("222")
        page.expense_type("Транспортные услуги")
        page.amount("95 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "79 166,67")
        page.checker.check_text_input("ndsAmount", "15 833,33")
        page.comment("Транспортные услуги")
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("226")
        page.expense_type("Хозяйственные расходы")
        page.amount("156 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "130 000,00")
        page.checker.check_text_input("ndsAmount", "26 000,00")
        page.comment("Хозяйственные расходы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("290")
        page.expense_type("Прочие расходы")
        page.amount("250 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "208 333,33")
        page.checker.check_text_input("ndsAmount", "41 666,67")
        page.comment("Прочие расходы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("310")
        page.expense_type("строительно-монтажные работы")
        page.amount("145 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "120 833,33")
        page.checker.check_text_input("ndsAmount", "24 166,67")
        page.comment("строительно-монтажные работы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Снятие наличных в кассу")
        page.kbk("0411 0000000000 000")
        page.kosgu("340")
        page.expense_type("Мягкий инвентарь")
        page.amount("123 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "102 500,00")
        page.checker.check_text_input("ndsAmount", "20 500,67")
        page.comment("Мягкий инвентарь")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)
        page.checker.check_text_input("amount", "889 000,00")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

        page.wait.text_appear(' Приходный кассовый ордер')

        page.table_select_row('Снято с расчетного счета')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("22.01.2018")
        # page.operation_master("") указываем если требуется проводку
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено")
        page.click_by_text("Закрыть")
        page.table_select_row('Снято с расчетного счета')
        page.click_by_text("Действия")
        page.click_by_text("Просмотр проводок")

    def te1st_incoming_order_print(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.table_select_row('Снято с расчетного счета')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Приходный кассовый ордер.xls')

    def te1st_incoming_order_copy_doc(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.table_select_row('889 000,00')
        page.click_by_text("Добавить")
        page.click_by_text("Копию документа")
        page = IncomingOrderPage(self.driver)
        page.document_kind("Приходный кассовый ордер (получение наличных из банка в кассу по чеку)")
        page.document_number("2")
        page.document_date("25.01.2018")
        page.employee("Старостина Е.В.")
        page.received_from("Оприходавано в кассу")
        page.cash_report_number("1234567890")
        page.foundation("Чек 12125")
        page.operation('Получение наличных в кассу')

        page = IncomingOrderAddLinePage(self.driver)
        page.table_select_row_click('221')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("120 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "100 000,00")
        page.checker.check_text_input("ndsAmount", "20 000,00")
        page.comment("Услуги связи")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.table_select_row_click('222')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("95 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "79 166,67")
        page.checker.check_text_input("ndsAmount", "15 833,33")
        page.comment("Транспортные услуги")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.table_select_row_click('226')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("156 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "130 000,00")
        page.checker.check_text_input("ndsAmount", "26 000,00")
        page.comment("Хозяйственные расходы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.table_select_row_click('290')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("250 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "208 333,33")
        page.checker.check_text_input("ndsAmount", "41 666,67")
        page.comment("Прочие расходы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.table_select_row_click('310')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("145 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "120 833,33")
        page.checker.check_text_input("ndsAmount", "24 166,67")
        page.comment("строительно-монтажные работы")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.table_select_row_click('340')
        page.click_by_text("Открыть")
        page.operation("Получение наличных в кассу")
        page.amount("123 000,00")
        page.nds_percent("20")
        page.checker.check_text_input("amountWithoutNds", "102 500,00")
        page.checker.check_text_input("ndsAmount", "20 500,67")
        page.comment("Мягкий инвентарь")
        # Мол надо удалить!!!!!!!!!!!!!!!!!!
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)

        page.checker.check_text_input("amount", "889 000,00")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

        page.table_select_row('Оприходавано в кассу')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("25.01.2018")
        # page.operation_master("") указываем если требуется проводку
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.click_by_text("Закрыть")
        page.table_select_row('Оприходавано в кассу')
        page.click_by_text("Действия")
        page.click_by_text("Просмотр проводок")

    def te1st_incoming_order_copy_doc_print(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.table_select_row('Оприходавано в кассу')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Приходный кассовый ордер (1).xls')

    def te1st_invoice_from_the_supplier_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Февраль", "2018")
        page.click_by_text("Счет от поставщика")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = InvoiceFromTheSupplierPage(self.driver)
        page.document_number("5")
        page.document_date("01.02.2018")
        page.supplier('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.supplier_account_detail("40702810500000002308")
        page.account_details("ПАО Банк ВТБ")
        # page.department("Департамент внешних коммуникаций")
        page.note('Аудиторские услуги , февраль 2018')
        sleep(4)

        # Добавляем документ счет от поставщика строку

        page = InvoiceFromTheSupplierAddLinePage(self.driver)
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.kbk("0411 0000000000 000")
        page.kosgu("226")
        page.cost_element("Прочие услуги")
        page.comment("Справочно-информационные услуги")
        page.amount("100 000,00")

        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_application_cash_flow_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Февраль", "2018")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        sleep(1)
        page.documen_type("Заявка на кассовый расход")
        page.number("1")
        page.date("02.02.2018")
        page.limit_date("12.02.2018")
        page.personal_account("ПАО Банк ВТБ")
        page.recipient('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.bank_account_number("40702810500000002308")
        page.number_ufk("123456789012345")
        # Заполнение вкладки дкоумент основание
        page.click_by_text("Документ-основание")
        page.foundation("5 от 01.02.2018")
        page.checker.check_text_select("documentFoundaiontKind", 'Счет от поставщика')
        page.checker.check_text_input("documentFoundationNumber", '5')
        page.checker.check_text_input("documentFoundationSubject", 'Аудиторские услуги , февраль 2018')
        page.checker.check_text_input("documentFoundationDate", '01.02.2018')
        # Расшифровка заявки - добавление строки
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = DecodingOfTheApplicationPage(self.driver)
        page.kbk("0411 0000000000 000")
        page.drawee_kbk_type('Классификация расходов бюджетов (КРБ)')
        page.operation("(226) Оплата за прочие услуги")
        page.kosgu("226")
        sleep(5)
        page.cost_element("Прочие услуги")
        page.amount("100000")
        page.document_foundation_counterparty('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.foundation("5 от 01.02.2018")
        page.comment("Оплата аудиторских услуг, Февраль 2018")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input("paymentPurpose",
                                      "(07104110000000000000 226 - 100000.00)(л/сч )Прочие услуги.НДС не обл.")
        page.click_by_text("Сохранить")

        # Добавляем копию строки
        page.click_by_text("Расшифровка заявки")
        # Исправить после доработки функционала!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        # page.click_by_text("Добавить")
        # page.click_by_text("Копию строки")

        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.comment("Строка для удаления")
        sleep(5)
        page.click_by_text("Сохранить", 2)

        page.search_string('Строка для удаления', 'Выбор строки для удаления')
        page.table_select_row_click('Строка для удаления')
        page.click_by_text("Удалить")
        page.click_by_text("Да")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Заявка на кассовый расход (2).xls')

    def te1st_application_cash_flow_two_copy(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Февраль", "2018")
        # Создание копии документа
        page.table_select_row('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.click_by_text("Добавить")
        page.click_by_text("Копию документа")
        page = ApplicationCashFlowPage(self.driver)
        sleep(1)
        page.documen_type("Заявка на кассовый расход")
        page.number("2")
        page.date("10.02.2018")
        page.limit_date("20.02.2018")
        page.personal_account("ПАО Банк ВТБ")
        page.recipient('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.bank_account_number("40702810500000002308")
        page.number_ufk("123456789012345")
        # Заполнение вкладки дкоумент основание
        page.click_by_text("Документ-основание")
        page.foundation("5 от 01.02.2018")
        page.checker.check_text_select("documentFoundaiontKind", 'Счет от поставщика')
        page.checker.check_text_input("documentFoundationNumber", '5')
        page.checker.check_text_input("documentFoundationSubject", 'Аудиторские услуги , февраль 2018')
        page.checker.check_text_input("documentFoundationDate", '01.02.2018')
        # Расшифровка заявки - добавление строки
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Открыть")
        page = DecodingOfTheApplicationPage(self.driver)
        page.kbk("0411 0000000000 000")
        page.drawee_kbk_type('Классификация расходов бюджетов (КРБ)')
        page.operation("(226) Оплата за прочие услуги")
        page.kosgu("226")
        sleep(5)
        page.cost_element("Прочие услуги")
        page.amount("100000")
        page.document_foundation_counterparty('ООО Аудиторская компания "Аудит Проф Гарант"')
        page.foundation("5 от 01.02.2018")
        page.comment("Оплата аудиторских услуг, Февраль 2018")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input("paymentPurpose",
                                      "(07104110000000000000 226 - 100000.00)(л/сч )Прочие услуги.НДС не обл.")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_application_cash_flow_export_ufk(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page = ApplicationCashFlowPage(self.driver)
        page.click_by_text("Заявка на кассовый расход")
        page.select_month("Февраль", "2018")
        page.table_select_row('10.02.2018')
        page.click_by_text("Действия")
        page.click_by_text("Экспорт в УФК")
        page.wait.text_appear('Экспорт данных в СУФД ФК')
        page = ExportUFKPage(self.driver)
        page.account_details("ПАО Банк ВТБ")
        page.file_number("1")
        page.click_by_text("Сохранить")
        sleep(5)
        File.checking_file_export_ufk()
        page.click_by_text("Действия")
        page.click_by_text("Аннулировать заявку")
        page.wait.text_appear('Результат аннулирования документов')

        page.checker.check_message('Аннулировано документов: 1 Не аннулировано: 0')
        page.click_by_text("Закрыть")

    def te1st_invoice_from_the_supplier_three(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Март", "2018")
        page.click_by_text("Счет от поставщика")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = InvoiceFromTheSupplierPage(self.driver)
        page.document_number("10")
        page.document_date("01.03.2018")
        page.supplier('ГУП "МТРК')
        page.supplier_account_detail("30302810900000023400")
        page.account_details("ПАО Банк ВТБ")
        # page.department("Департамент внешних коммуникаций")
        page.note('Услуги по ремонту зданий , март 2018')
        sleep(4)
        # Добавляем документ счет от поставщика строку
        page = InvoiceFromTheSupplierAddLinePage(self.driver)
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.kbk("0411 0000000000 000")
        page.kosgu("225")
        page.cost_element("текущий ремонт")
        page.comment("Косметический ремонт зданий и сооружений организации")
        page.amount("250 000,00")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        # Помечаем документ
        page.table_select_row('01.03.2018')
        page.click_by_text("Действие")
        element = self.driver.find_element(By.XPATH, "//li[a='Создать документ по выбору']")
        page.move_to_element(element)
        page.click_by_text("Заявка на кассовый расход")
        page.checker.check_text_select('documentKind', 'Заявка на кассовый расход')
        page.checker.check_text_input('documentNumber', '4')
        page.checker.check_text_input('documentDate', '02.03.2018')
        page.checker.check_text_input('limitDate', '12.03.2018')
        # page.number("4")
        # page.date("02.03.2018")
        # page.limit_date("12.03.2018")
        page = ApplicationCashFlowPage(self.driver)
        page.personal_account("УФК л/с 03951000710")
        page.checker.check_text_select('counterparty', 'ГУП "МТРК')
        page.checker.check_text_select('counterpartyAccountDetails', "30302810900000023400")
        page.number_ufk("123456789012345")
        page.operation('Оплата за приобретение ОС')
        page.priority_of_payment('5')
        page.payment_type('4 – срочно')
        # Заполнение вкладки дкоумент основание
        page.click_by_text("Документ-основание")
        page.checker.check_text_select("foundation", '10 от 01.03.2018')
        page.checker.check_text_select("documentFoundaiontKind", 'Счет от поставщика')
        page.checker.check_text_input("documentFoundationNumber", '10')
        page.checker.check_text_input("documentFoundationSubject", 'Поставка оборудования , январь 2018')
        page.checker.check_text_input("documentFoundationDate", '01.03.2018')
        # Расшифровка заявки - добавление строки
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Открыть")
        page = DecodingOfTheApplicationPage(self.driver)
        # page.kbk("0411 0000000000 000")
        page.checker.check_text_input("amount", "250 000,00", 2)
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Реквизиты документа")
        page.click_by_text("Назначения платежа")
        page.checker.check_text_input(
            "paymentPurpose", "(07104110000000000000 225 - 250000.00)(л/сч 03951000710)текущий ремонт.НДС не обл.")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_return_request(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Март", "2018")
        page.click_by_text("Заявка на возврат")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = ReturnRequestPage(self.driver)
        page.document_number("15")
        page.document_date("01.03.2018")
        page.account_details("ПАО Банк ВТБ")
        page.recepient('ЗАО "ГЛОБУС-ТЕЛЕКОМ"')
        page.ofk_registration_number("073")
        page.entry_date("01.03.2018")
        page.operation("(226) Возврат авансового платежа на л/сч")
        page.recepient_account_details("40702810400000002194")
        page.kbk("0411 0000000000 000")
        page.kosgu("226")
        page.outstanding_payment_document_amount("500,00")
        page.click_by_text("Уполномоченные сотрудники")
        page.chief("Е.Ю.Петрова")
        page.chief_accountant("С.В. Васина")
        page.click_by_text("Расшифровка заявки")
        page.priority_of_payment('5')
        page.payment_purpose('Назначение платежа - тест')
        page.payment_type('4 – срочно')
        page.type_funds_for_return('1 - Средства бюджета')
        page.click_by_text("Сохранить")
        page.click_by_text("Расшифровка заявки")
        page.click_by_text("Назначение платежа")
        page.checker.check_text_input("paymentPurpose", "()(л/сч ).НДС не обл.")
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('ЗАО "ГЛОБУС-ТЕЛЕКОМ"')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Заявка на возврат.xls')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("05.03.2018")
        page.operation_master("(226) Возврат авансового платежа на л/сч")
        page.click_by_text("Провести", order=2)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено")
        page.click_by_text("Закрыть")
        page.click_by_text("Действия")
        page.click_by_text("Экспорт в УФК")
        page.wait.text_appear('Экспорт данных в СУФД ФК')
        page = ExportUFKPage(self.driver)
        page.account_details("ПАО Банк ВТБ")
        page.file_number("1")
        page.click_by_text("Сохранить")
        sleep(5)
        File.checking_file_export_ufk()
        page.click_by_text("Действия")
        page.click_by_text("Аннулировать заявку")
        page.wait.text_appear('Результат аннулирования документов')
        page.checker.check_message('Аннулировано документов: 1 Не аннулировано: 0')
        page.click_by_text("Закрыть")

    def te1st_application_for_cash_withdrawal(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Апрель", "2018")
        page.click_by_text("Заявка на получение наличных денег")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = ApplicationForCashWithdrawalPage(self.driver)
        page.document_number("20")
        page.document_date("01.04.2018")
        page.entry_date("01.04.2018")
        page.deadline("11.04.2018")
        page.account_details("ПАО Банк ВТБ")
        page.tracking_number("123")
        # page.operation_master("OperationMaster")
        page.click_by_text("Дополнительно")
        page.trustee("Канакова Е.Д.")
        page.trustee_name_dative_case("Канаковой Елене")
        page.trustee_position("Ведущий специалист-эксперт")
        page.trustee_position_dative_case("Ведущему специалист-эксперту")
        page.checker.check_text_input("trusteePassport", 'Паспорт гражданина РФ серия 22  №691179,'
                                                         ' выдан 1 февраля 2011 года,'
                                                         ' ОУФМС России по Нижегородской обл.'
                                                         ' в Автозаводском р-н г. Нижнего Новгорода')
        page.check_series("МЕ")
        page.check_number("12160977")
        page.check_date("30.04.2018")
        page.check_valid_till("30.05.2018")
        page.chief("Н.В. Шубина")
        page.accountant_general("С.В. Васина")
        page.foundation("Основание")
        sleep(5)
        # Добавляем строку документа
        page.click_by_text("Строки документа")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = ApplicationForCashWithdrawalAddLinePage(self.driver)
        page.kbk("0411 0000000000 000")
        page.kosgu("211")
        page.cost_element("Услуги VIP-зала")
        page.funds_source("1 - Средства бюджета")
        page.cash_transaction_code("40 Выдачи на заработную плату и выплаты социального характера")
        page.amount("2800000,00")
        page.payment_purpose("Премия")
        page.comment("40")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('01.04.2018')
        # page.click_by_text("Печать")
        sleep(8)
        File.compare_files('Заявка на получение наличных денег.xls')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("05.04.2018")
        page.operation_master("Поступление денежных средств по 211")
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено")
        page.click_by_text("Закрыть")
        page.click_by_text("Действия")
        page.click_by_text("Экспорт в УФК")
        page.wait.text_appear('Экспорт данных в СУФД ФК')
        page = ExportUFKPage(self.driver)
        page.account_details("ПАО Банк ВТБ")
        page.file_number("1")
        page.click_by_text("Сохранить")
        sleep(5)
        File.checking_file_export_ufk()
        page.click_by_text("Действия")
        page.click_by_text("Создать ПКО на получение наличных")
        sleep(10)
        page = IncomingOrderPage(self.driver)
        page.document_kind("Приходный кассовый ордер (получение наличных из банка в кассу по чеку)")
        page.checker.check_text_input('documentNumber', '3')
        page.checker.check_text_input('documentDate', '01.04.2018')
        page.checker.check_text_input('receivedFrom', 'Канакова Елизавета Дмитриевна')
        page.checker.check_text_input('amount', '2 800 000,00')
        page.checker.check_text_select("employee", "Канакова Елизавета Дмитриевна")
        page.table_select_row_click('211')
        page.click_by_text("Сохранить")
        page.click_by_text('Закрыть')
        sleep(5)

    def te1st_incoming_order_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        # Должен быть апрель
        page.select_month("Апрель", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.table_select_row("Канакова Елизавета Дмитриевна")
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Приходный кассовый ордер (2).xls')

    def te1st_account_cash_warrant(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Расходный кассовый ордер")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = AccountCashWarrantPage(self.driver)
        page.document_kind("Расходный кассовый ордер на аванс")
        page.document_number("1")
        page.document_date("26.01.2018")
        page.entry_date("26.01.2018")
        page.employee('Трубникова Т.Н.')
        page.checker.check_text_input("issue", "Трубникова Т.Н.")
        page.checker.check_text_input(
            "byDocument", "Паспорт гражданина РФ серия 46  №634469, выдан 20 июля 2007 года,"
                          " ТП № 4 в г. Мытищи ОУФМС России по Моск. обл. в Мытищинском р-не")
        page.foundation("Выдано на оплату услуг")
        page.cash_report_number("777")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        # Добавили 1 строку
        page = AccountCashWarrantPageAddLine(self.driver)
        page.operation("Выдача из кассы под отчет (основные средства)")
        page.kbk("0411 0000000000 000")
        page.kosgu("221")
        page.cost_element("Услуги связи")
        page.amount("10 000,00")
        page.comment("На оплату услуг связи")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        # Добавили 2 строку
        page.table_select_row_click("221")
        page.click_by_text("Добавить")
        page.click_by_text("Копию строки")
        page.table_select_row_click("0,00")
        page.click_by_text("Открыть")
        page.operation("(222) Оплата за транспортные услуги")
        page.kbk("0411 0000000000 000")
        page.kosgu("222")
        page.cost_element("Транспортные услуги")
        page.amount("1 000,00")
        page.comment("На оплату услуг такси")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('Выдано на оплату услуг')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("26.01.2018")
        page.operation_master("Выдача из кассы под отчет (основные средства)")
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено документов: 1 Не проведено: 0")
        page.click_by_text("Закрыть")

    def te1st_account_cash_warrant_print(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Расходный кассовый ордер")
        page.table_select_row("11 000,00")
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Расходный кассовый ордер.xls")

    def te1st_account_cash_warrant_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Расходный кассовый ордер")
        # Добавляем второй документ
        page.table_select_row("11 000,00")
        page.click_by_text("Добавить")
        page.click_by_text("Копию документа")
        page = AccountCashWarrantPage(self.driver)
        page.checker.check_text_select("documentKind", "РКО на аванс")
        page.document_number("2")
        page.document_date("27.01.2018")
        page.entry_date("27.01.2018")
        page.checker.check_text_select("employee", "Трубникова Татьяна Николаевна")
        page.checker.check_text_input("issue", "Трубникова Татьяна Николаевна")
        page.checker.check_text_input(
            "byDocument", "Паспорт гражданина РФ серия 46  №634469, выдан 20 июля 2007 года,"
                          " ТП № 4 в г. Мытищи ОУФМС России по Моск. обл. в Мытищинском р-не")
        page.foundation("Выдано на приобретение МЗ и ОС для нужд учреждения")
        page.checker.check_text_input("cashReportNumber", "777")
        # Редактируем 1 строку
        page = AccountCashWarrantPageAddLine(self.driver)
        page.table_select_row_click("221")
        page.click_by_text("Открыть")
        page.operation("Выдача из кассы под отчет (основные средства)")
        page.kbk("0411 0000000000 000")
        page.kosgu("310")
        page.cost_element("основные средства")
        page.amount("25 000,00")
        page.comment("На приобретение материалов")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page = AccountCashWarrantPageAddLine(self.driver)
        page.table_select_row_click("222")
        page.click_by_text("Открыть")
        page.operation("Выдача под отчет из кассы (340)")
        page.kbk("0411 0000000000 000")
        page.kosgu("340")
        page.cost_element("Материальные запасы")
        page.amount("15 000,00")
        page.comment("На приобретение канцтоваров")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('Выдано на приобретение МЗ и ОС для нужд учреждения')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("27.01.2018")
        page.operation_master("Выдача из кассы под отчет (основные средства)")
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено документов: 1 Не проведено: 0")
        page.click_by_text("Закрыть")

    def te1st_account_cash_warrant_two_print(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Расходный кассовый ордер")
        page.table_select_row("40 000,00")
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Расходный кассовый ордер (1).xls")

    def te1st_incoming_order_three(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = IncomingOrderPage(self.driver)
        page.document_kind("Приходный кассовый ордер")
        page.document_number("3")
        page.document_date("30.01.2018")
        page.employee("Трубникова Т.Н.")
        page.checker.check_text_input("receivedFrom", "Трубникова Т.Н.")
        page.cash_report_number("1234567890")
        page.foundation("Возврат не использованных средств")
        page.operation('Внесение наличных по оплате услуг связи')
        page = IncomingOrderAddLinePage(self.driver)
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page.operation("Внесение наличных по оплате услуг связи")
        page.kbk("0411 0000000000 000")
        page.kosgu("221")
        page.expense_type("Услуги связи")
        page.amount("3 562,00")
        page.comment("Остаток возврат в кассу")
        page.recepient('МОЛ ФМС')
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.table_select_row('30.01.2018')
        page.click_by_text("Действия")
        page.click_by_text("Провести помеченные")
        page = CarryingOutOfDocumentsPage(self.driver)
        page.lddate_prov("30.01.2018")
        # page.operation_master("") указываем если требуется проводку
        page.click_by_text("Провести", order=3)
        page.wait.text_appear('Результат проведения документов')
        page.checker.check_message("Проведено документов: 1 Не проведено: 0")
        page.click_by_text("Закрыть")

    def te1st_incoming_order_three_print(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Приходный кассовый ордер")
        page.table_select_row("3 562,00")
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files('Приходный кассовый ордер (3).xls')

    def te1st_posting_journal(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Журнал проводок")
        page = PostingJournalPage(self.driver)
        page.date_from("01.01.2018")
        page.date_by("31.01.2018")
        page.balance_sheet_account("1 201 34")
        page.click_by_text("Сформировать")
        sleep(10)
        page.search_by_two_attributes("1 201 34", "1 210 03")

    def te1st_turnover_statement_two(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page = TurnoverStatementPage(self.driver)
        page.click_by_text("Оборотная ведомость", order=2)
        page.date_from("01.01.2018")
        page.date_to("31.01.2018")
        page.click_by_text("Показать")
        page.wait.text_appear('Печать "Оборотная ведомость"')
        page.click_by_text('Печать "Оборотная ведомость"')
        sleep(10)
        File.compare_files('Оборотная ведомость (1).xls')

    def te1st_basis_for_reporting_amounts(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Основание для выдачи подотчетных сумм")
        page.click_by_text("Добавить")
        page.click_by_text("Новый документ")
        page = BasisForReportingAmountsPage(self.driver)
        sleep(5)
        # page.number("1")
        page.document_date("26.01.2018")
        page.document_kind("Хозрасходы")
        page.employee("Трошин Ю.Н.")
        page.position("Ведущий специалист-эксперт")
        page.department("Аппарат Министра")
        page.trip_start_date("26.01.2018")
        page.trip_end_date("27.01.2018")
        page.checker.check_text_input('tripDays', '2')
        page.comment("На хознужды")
        page.trip_route("В рамках субьекта РФ")
        page.click_by_text("Строки документа")
        page.click_by_text("Добавить")
        page.click_by_text("Новую строку")
        page = BasisForReportingAmountsAddLinePage(self.driver)
        page.kbk("0411 0000000000 000")
        page.kosgu("226")
        page.cost_element("Хозяйственные расходы")
        page.employee("Трошин Ю.Н.")
        page.amount("5 000,00")
        page.comment("На хознужды")
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('5 000,00')
        page.click_by_text("Добавить")
        page.click_by_text("Копию строки")
        sleep(3)
        page.table_select_row_click('На хознужды', order=2)
        page.click_by_text("Открыть")
        page = BasisForReportingAmountsAddLinePage(self.driver)
        page.kbk("0411 0000000000 000")
        page.kosgu("290")
        page.cost_element("представительские расходы")
        page.employee("Трошин Ю.Н.")
        page.amount("3 500,00")
        page.comment("На представительские расходы")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")

    def te1st_basis_for_reporting_amounts_plus_rko_advance_payment(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Основание для выдачи подотчетных сумм")
        page.table_select_row('26.01.2018')
        page.click_by_text("Действия")
        element = self.driver.find_element(By.XPATH, "//li[a='Создать на основании текущего документа']")
        page.move_to_element(element)
        page.click_by_text("Расходный кассовый ордер на аванс")
        page = AccountCashWarrantPage(self.driver, 5)
        page.checker.check_text_select('documentKind', 'РКО на аванс')
        page.document_number("3")
        page.document_date("27.01.2018")
        page.entry_date("27.01.2018")
        page.checker.check_text_select('employee', 'Трошин Юрий Николаевич')
        page.checker.check_text_input('issue', 'Трошин Юрий Николаевич')
        page.checker.check_text_input(
            "byDocument", "Паспорт серия 04 45 №894269, выдан 27.12.2002  "
                          "  Паспортным столом № 2 ОВД \"Отрадное\" г. Москвы")
        page.checker.check_text_input("foundation", "На хознужды")
        page.cash_report_number("777")
        page.checker.check_text_input("amount", "8 500,00")
        page.click_by_text("Приложение")
        page.checker.check_text_select("documentFoundation", '№1 от 26.01.2018')
        page.click_by_text("Строки документа")
        page.table_select_row_click('226')
        page.click_by_text("Открыть")
        page = AccountCashWarrantPageAddLine(self.driver)
        page.operation("Выдача из кассы в подотчет (прочие)")
        page.checker.check_text_select("kbk", "0411 0000000000 000")
        page.checker.check_text_select("kosgu", "226")
        page.checker.check_text_select("costElement", "Хозяйственные расходы")
        page.checker.check_text_input("amount", "5 000,00", 2)
        page.checker.check_text_input("comment", "На хознужды")
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('290')
        page.click_by_text("Открыть")
        page = AccountCashWarrantPageAddLine(self.driver)
        page.operation("Выдача из кассы в подотчет (предс)")
        page.checker.check_text_select("kbk", "0411 0000000000 000")
        page.checker.check_text_select("kosgu", "290")
        page.checker.check_text_select("costElement", "представительские расходы")
        page.checker.check_text_input("amount", "3 500,00", 2)
        page.checker.check_text_input("comment", "На представительские расходы")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        sleep(10)
        page.table_select_row('26.01.2018')
        page.click_by_text("Открыть")
        page.click_by_text("Связанные документы")
        page.table_select_row('27.01.2018')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Расходный кассовый ордер (2).xls")
        page.click_by_text("Закрыть")

    def te1st_basis_for_reporting_amounts_plus_avans_report(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Основание для выдачи подотчетных сумм")
        page.table_select_row('26.01.2018')
        page.click_by_text("Действия")
        element = self.driver.find_element(By.XPATH, "//li[a='Создать на основании текущего документа']")
        page.move_to_element(element)
        page.click_by_text("Авансовый отчет")
        page = AvansReportPage(self.driver)
        page.document_kind('Приход ТМЦ')
        page.document_number('2')
        page.document_date('30.01.2018')
        page.entry_date('30.01.2018')
        page.checker.check_text_input('employeeFullName', 'Трошин Юрий Николаевич')
        page.checker.check_text_select('employee', 'Трошин Ю.Н.')
        page.checker.check_text_select('position', 'Вед.спец.-эксперт')
        page.checker.check_text_select('documentFoundation', '1 от 26.01.2018')
        page.checker.check_text_input('purpose', 'На хознужды')
        page.table_select_row_click('226')
        page.click_by_text("Открыть")
        page = AvansReportAddLinePage(self.driver)
        page.operation_master('221. Авансовый отчет (оплата за услуги связи)')
        page.kbk('0411 0000000000 000')
        page.kosgu('221')
        page.cost_element('Услуги связи')
        page.document_date('30.01.2018')
        page.document_number('2')
        page.amount('4 560,00')
        page.comment('На прочие услуги. Списание расходов по слугам связи')
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('290')
        page.click_by_text("Открыть")
        page.operation_master('225. Авансовый отчет (услуги по содержанию имущ-ва)  мойка автомобиля')
        page.kbk('0411 0000000000 000')
        page.kosgu('225')
        page.cost_element('Услуги по содержанию имущества')
        page.document_date('30.01.2018')
        page.document_number('1')
        page.amount('4 200,00')
        page.comment('На представительские расходы. Списание расходов по содержанию имущества')
        page.click_by_text("Сохранить", 2)
        page.checker.check_text_input('amount', '8 760,00')
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.search_by_two_attributes('-260,00', '8 760,00')
        page.click_by_text("Открыть")
        page.click_by_text("Связанные документы")
        page.table_select_row('30.01.2018')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Авансовый отчет.xls")
        page.click_by_text("Закрыть")

    def te1st_basis_for_reporting_amounts_plus_income_order_for_the_balance(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Основание для выдачи подотчетных сумм")
        page.table_select_row('26.01.2018')
        page.click_by_text("Действия")
        element = self.driver.find_element(By.XPATH, "//li[a='Создать на основании текущего документа']")
        page.move_to_element(element)
        page.click_by_text("Расходный/Приходный кассовый ордер на остаток")
        page.click_by_text("Связанные документы")
        page.search_by_two_attributes('Приходный кассовый ордер', '8 500,00')
        page.click_by_text("Открыть", 2)
        page = IncomingOrderPage(self.driver)
        sleep(5)
        page.document_kind("Приходный кассовый ордер")
        page.document_date("30.01.2018")
        page.entry_date("30.01.2018")
        page.checker.check_text_select("employee", "Трошин Юрий Николаевич")
        page.checker.check_text_input("receivedFrom", "Трошин Ю.Н.")
        page.checker.check_text_input("foundation", "На хознужды")
        page.checker.check_text_input('amount', '8 500,00')
        page.click_by_text("Приложение")
        page.checker.check_text_select("documentFoundation", "№ 1 от 26.01.2018")
        page.checker.check_text_select("advanceReport", "2 от 30.01.2018")
        page.click_by_text("Строки документа")
        page.table_select_row_click('226')
        page.click_by_text("Открыть")
        page = IncomingOrderAddLinePage(self.driver)
        page.operation("Поступление денежных средств по 226 статье")
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('290')
        page.click_by_text("Открыть")
        page.operation("Возврат в кассу аванса (проч. расходы )")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.click_by_text("Связанные документы")
        page.search_by_two_attributes('Приходный кассовый ордер', '8 500,00')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Приходный кассовый ордер (4).xls")

    def test_basis_for_reporting_amounts_plus_expenditure_order_for_the_balance(self):
        page = MenuPage(self.driver)
        page.click_to_eagle()
        page.select_month("Январь", "2018")
        page.click_by_text("Основание для выдачи подотчетных сумм")
        page.table_select_row('26.01.2018')
        page.click_by_text("Открыть")
        page.click_by_text("Связанные документы")
        page.search_by_two_attributes('Расходный кассовый ордер', '8 760,00')
        page.click_by_text("Открыть", 2)
        sleep(5)
        page.checker.check_text_select('documentKind', 'Расходный кассовый ордер')
        page.checker.check_text_select('employee', 'Трошин Юрий Николаевич')
        page.checker.check_text_input('issue', 'Трошин Юрий Николаевич')
        page.checker.check_text_input(
            "byDocument", "Паспорт серия 04 45 №894269, выдан 27.12.2002  "
                          "  Паспортным столом № 2 ОВД \"Отрадное\" г. Москвы")
        page.checker.check_text_input("foundation", "На хознужды")
        page.checker.check_text_input("amount", "8 760,00")
        page.click_by_text("Приложение")
        page.checker.check_text_select("documentFoundation", '№1 от 26.01.2018')
        page.checker.check_text_select("advanceReport", '2 от 30.01.2018')
        page.click_by_text("Строки документа")
        page.table_select_row_click('221')
        page.click_by_text("Открыть")
        page = AccountCashWarrantPageAddLine(self.driver)
        page.operation("Выдача в подотчет по 221 статье")
        page.click_by_text("Сохранить", 2)
        page.table_select_row_click('225')
        page.click_by_text("Открыть")
        page.operation("Выдача из кассы в подотчет (прочие)")
        page.click_by_text("Сохранить", 2)
        page.click_by_text("Сохранить")
        page.click_by_text("Закрыть")
        page.click_by_text("Связанные документы")
        page.search_by_two_attributes('Расходный кассовый ордер', '8 760,00')
        page.click_by_text("Печать")
        sleep(10)
        File.compare_files("Расходный кассовый ордер (3).xls")












